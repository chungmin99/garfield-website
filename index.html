<html>

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0J350BP7YE"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-0J350BP7YE');
    </script>

    <meta charset="utf-8" />
    <title>GARField: Group Anything with Radiance Fields</title>

    <!-- TODO double check these are updated -->
    <!-- Website Metadata -->
    <meta content="Hierarchical grouping in 3D by training a scale-conditioned affinity field from multi-level masks"
        name="description" />
    <meta content="GARField: Group Anything with Radiance Fields" property="og:title" />
    <meta content="Hierarchical grouping in 3D by training a scale-conditioned affinity field from multi-level masks"
        property="og:description" />
    <meta content="http://www.garfield.studio/data/preview_card.jpg" property="og:image" />
    <meta content="GARField: Group Anything with Radiance Fields" property="twitter:title" />
    <meta content="Hierarchical grouping in 3D by training a scale-conditioned affinity field from multi-level masks"
        property="twitter:description" />
    <meta content="http://www.garfield.studio/data/preview_card.jpg" property="twitter:image" /> 
    <meta property="og:type" content="website" />
    <meta content="summary_large_image" name="twitter:card" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" /> 


    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous" />
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script
        type="text/javascript">WebFont.load({ google: { families: ["Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic", "Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic", "Ubuntu:300,300italic,400,400italic,500,500italic,700,700italic", "Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic", "Changa One:400,400italic", "Varela Round:400", "Bungee Shade:regular", "Roboto:300,regular,500", "Bungee Outline:regular"] } });</script>
    <!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif]-->

    <!-- JQuery, scripts etc -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="script.js" type="text/javascript"></script>
    <script src="js/carousel_utils.js" type="text/javascript"></script>

    <!-- Stylesheets; tabler icons, fonts, ...-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link href="style.css" rel="stylesheet" type="text/css" />

    <link href="data/favicon.png" rel="shortcut icon" type="image/x-icon" />
</head>

<body>
    <div>
        <!-- Title, Subtitle, Authors -->
        <div>
            <h1 class="title">
                <img src="data/favicon.png" style="height: 40px; margin-bottom: -3px">
                GARField
                <img src="data/favicon.png" style="height: 40px; margin-bottom: -3px">
            </h1>
            <h1 class="subheader"> Group Anything with Radiance Fields</h1>

            <!-- Author list -->
            <div class="base-row">
                <!-- Refer to how author wrapping is performed in https://brentyi.github.io/tilted/ -->
                <div style="padding: 2px;">
                    <a href="https://chungmin99.github.io/" target="_blank" class="author-text">
                        Chung Min Kim
                        <span class="text-star">*,1</span>
                    </a>
                    <div style="width: 1.25em; display: inline-block"></div>
                    <a href="https://github.com/WMXwmxwalter" target="_blank" class="author-text">
                        Mingxuan Wu
                        <span class="text-star">*,1</span>
                    </a>
                    <div style="width: 1.25em; display: inline-block"></div>
                    <a href="https://kerrj.github.io/" target="_blank" class="author-text">
                        Justin Kerr
                        <span class="text-star">*,1</span>
                    </a>
                </div>
                <div style="padding: 2px;">
                    <div style="width: 1.25em; display: inline-block"></div>
                    <a href="https://goldberg.berkeley.edu/" target="_blank" class="author-text">
                        Ken Goldberg
                        <span class="text-star">1</span>
                    </a>
                    <div style="width: 1.25em; display: inline-block"></div>
                    <a href="https://www.matthewtancik.com" target="_blank" class="author-text">
                        Matthew Tancik
                        <span class="text-star">2</span>
                    </a>
                    <div style="width: 1.25em; display: inline-block"></div>
                    <a href="https://people.eecs.berkeley.edu/~kanazawa/" target="_blank" class="author-text">
                        Angjoo Kanazawa
                        <span class="text-star">*,1</span>
                    </a>
                </div>
            </div>
            <div style="text-align: center">
                <h1 id="uc-berkeley"><span class="text-star">1</span> UC Berkeley <span class="text-star">2</span> Luma AI</h1>
                <span class="text-star">*</span>Denotes Equal Contribution
            </div>
        </div>
        <!-- Submission status -->
        <!-- <div class="title-row">
            <h2 class="subheader">Arxiv Preprint 2024</h1>
        </div> -->

        <!-- Paper / code / data URLs -->
        <!-- TODO: Update arxiv/code/data link -->
        <div class="base-row add-top-padding">
            <!-- Paper -->
            <a target="_blank" class="link-block">
                <figure>
                    <img src="https://uploads-ssl.webflow.com/51e0d73d83d06baa7a00000f/5cab99df4998decfbf9e218e_paper-01.png"
                        alt="paper"
                        srcset="https://uploads-ssl.webflow.com/51e0d73d83d06baa7a00000f/5cab99df4998decfbf9e218e_paper-01-p-500.png"
                        style="max-height: 4em" />
                </figure>
                <figcaption>
                    <strong class="link-labels-text">Paper</strong>
                </figcaption>
            </a>
            <!-- Code -->
            <a href="https://github.com/chungmin99/garfield" target="_blank" class="link-block">
                <figure>
                    <img src="https://uploads-ssl.webflow.com/51e0d73d83d06baa7a00000f/5cae3b53b42ebb3dd4175a82_68747470733a2f2f7777772e69636f6e66696e6465722e636f6d2f646174612f69636f6e732f6f637469636f6e732f313032342f6d61726b2d6769746875622d3235362e706e67.png"
                        alt="code" style="max-height: 4em" />
                </figure>
                <figcaption>
                    <strong class="link-labels-text">&lt;/Code&gt;</strong>
                </figcaption>
            </a>
            <!-- Data -->
            <a target="_blank" class="link-block">
                <figure>
                    <img src="data/database_icon.jpg" alt="data" style="max-height: 4em" />
                </figure>
                <figcaption>
                    <strong class="link-labels-text">Data</strong>
                </figcaption>
            </a>
        </div>

        <!-- TL;DR + Teaser video -->
        <div class="section base-row add-top-padding">
            <h1 class="tldr">
                <b>TL;DR</b>:
                Hierarchical grouping in 3D by training a scale-conditioned affinity field from multi-level masks
            </h1>
            <video id="main-video" autobuffer muted autoplay loop controls>
                <source id="mp4" src="data/teaser.webm" type="video/webm">
                <source id="mp4" src="data/teaser.mp4" type="video/mp4">
            </video>
            <h1 class="tldr">
                GARField can extract assets at different granularities, like these from the above scene
            </h1>
            <div>
                <button class="teaser-slide-arrow" id="teaser-slide-arrow-prev" onclick="teaser_slide_left()">
                    &#8249;
                </button>
                <div class="teaser-slide-row" , id="teaser-objs-scroll">
                    <div class="base-col teaser-slide-col">
                        <video id="main-video" autobuffer muted autoplay loop playsinline>
                            <source id="mp4" src="data/object_carousel/dozer.webm" type="video/webm">
                            <source id="mp4" src="data/object_carousel/dozer.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="base-col teaser-slide-col">
                        <video id="main-video" autobuffer muted autoplay loop playsinline>
                            <source id="mp4" src="data/object_carousel/dozer_track.webm" type="video/webm">
                            <source id="mp4" src="data/object_carousel/dozer_track.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="base-col teaser-slide-col">
                        <video id="main-video" autobuffer muted autoplay loop playsinline>
                            <source id="mp4" src="data/object_carousel/miffy.webm" type="video/webm">
                            <source id="mp4" src="data/object_carousel/miffy.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="base-col teaser-slide-col">
                        <video id="main-video" autobuffer muted autoplay loop playsinline>
                            <source id="mp4" src="data/object_carousel/nerfgun.webm" type="video/webm">
                            <source id="mp4" src="data/object_carousel/nerfgun.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="base-col teaser-slide-col">
                        <video id="main-video" autobuffer muted autoplay loop playsinline>
                            <source id="mp4" src="data/object_carousel/nerf_dart.webm" type="video/webm">
                            <source id="mp4" src="data/object_carousel/nerf_dart.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="base-col teaser-slide-col">
                        <video id="main-video" autobuffer muted autoplay loop playsinline>
                            <source id="mp4" src="data/object_carousel/typewriter.webm" type="video/webm">
                            <source id="mp4" src="data/object_carousel/typewriter.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="base-col teaser-slide-col">
                        <video id="main-video" autobuffer muted autoplay loop playsinline>
                            <source id="mp4" src="data/object_carousel/book.webm" type="video/webm">
                            <source id="mp4" src="data/object_carousel/book.mp4" type="video/mp4">
                        </video>
                    </div>
                </div>
                <button class="teaser-slide-arrow" id="teaser-slide-arrow-next" onclick="teaser_slide_right()">
                    &#8250;
                </button>
            </div>
        </div>

        <div class="section base-row add-top-padding">
            <h1 id="abstract">Overview</h1>
            <p class="paragraph">
                Given multi-level masks from Segment Anything Model (SAM), GARField optimizes a <b>scale-conditioned affinity field</b> that describes how similar different 3D points are.
                 Grouping is a fundamentally ambiguous task, where input 2D masks may be overlapping or conflicting within and across views. 
                 GARField resolves these ambiguities by conditioning on <b>euclidean scene scale</b>, where it selects different groupings depending on their 3D size. 
                 Once trained, GARField can be either <b>interactively queried</b> by providing points along with a scale, or produce <b>globally consistent clusterings 
                 automatically</b> at a hierarchy of scales. The groups can be used for downstream tasks like  extraction or scene manipulation.
            </p>
            <h1 class="tldr"><b>
                Click the thumbnails below to load scenes, see groupings at different scales.
            </b></h1>
            <div id="main-results">
                <div class="switcher" data-switcher-title="Select hierarchy level">
                    <div data-switcher-label="Coarse"></div>
                    <div data-switcher-label="Medium"></div>
                    <div data-switcher-label="Fine"></div>
                </div>
                <div id="image-compare-canvas" class="image-compare" data-before-label="RGB" data-after-label="Global Clustering">
                    <canvas id="canvas"></canvas>
                </div>
                <div class="video-bar base-row">
                    <button id="play-btn" class="video-btn fa fa-lg fa-pause" onclick="play_pause()" style="margin-right: 0px;"></button>
                    <div style="position: absolute; right: 0px;">
                        <button class="video-btn fa fa-arrows-alt fa-lg" onclick="fullscreen()"></button>
                        <button class="video-btn fa fa-download fa-lg" onclick="download()"></button>
                    </div>
                </div>
                <div>
                    <button class="results-slide-arrow" id="results-slide-arrow-prev" onclick="results_slide_left()">
                        &#8249;
                    </button>
                    <div class="results-slide-row" id="results-objs-scroll">
                        <!-- <div data-img-src="data/favicon.png" data-label="Dozer"></div>
                        <div data-img-src="data/favicon.png" data-label="Bouquet"></div> -->
                        <div data-img-src="data/renders/keyboard/thumbnail.jpg" data-label="Keyboard"></div>
                        <div data-img-src="data/renders/succulent/thumbnail.jpg" data-label="Succulent"></div>
                        <div data-img-src="data/renders/louvre/thumbnail.jpg" data-label="Louvre statue"></div>
                        <div data-img-src="data/renders/bouquet/thumbnail.jpg" data-label="Bouquet"></div>
                        <div data-img-src="data/renders/donuts/thumbnail.jpg" data-label="Donuts"></div>
                        <div data-img-src="data/renders/dozer/thumbnail.jpg" data-label="Dozer"></div>
                        <div data-img-src="data/renders/nyc_cafe/thumbnail.jpg" data-label="Cafe"></div>
                    </div>
                    <button class="results-slide-arrow" id="results-slide-arrow-next" onclick="results_slide_right()">
                        &#8250;
                    </button>
                </div>
            </div> 
        </div>

        <!-- The story should be something like
            Why do you want to group in 3d?
            This is how to group in 3d.
            But we mentioned scale here. Why is scale important?
            In particular, why is using 3d scale important?
         -->

        <!-- Motivate hierarchical groups in 3D:
            Or more like, why group in 3D?
            Do we want to talk about lack of scale in SAM?
             - fusing information
             - 3D consistent labels
         -->

        <!-- Just for vertical spacing... -->
        <div class="section add-top-padding">
            <div class="base-row">
                <img src="data/favicon.png" style="height: 20px; margin-left: 5px; margin-right: 5px; margin-top: 40px; margin-bottom: 20px;">
                <img src="data/favicon.png" style="height: 20px; margin-left: 5px; margin-right: 5px; margin-top: 40px; margin-bottom: 20px;">
                <img src="data/favicon.png" style="height: 20px; margin-left: 5px; margin-right: 5px; margin-top: 40px; margin-bottom: 20px;">
            </div>
         </div>


        <div class="section add-top-padding">
            <div>
                <div class="base-row">
                    <div>
                        <h1>Interactive Selection</h1>
                        <p class="paragraph">
                            Given a single 3D point, GARField can select multiple groups by thresholding affinity across scale!
                        </p>
                        <video id="main-video" muted autoplay loop controls>
                            <source id="mp4" src="data/interactive_selection.webm" type="video/webm">
                        </video>
                    </div>
                    <div>
                        <h1>Automatic Decomposition</h1>
                        <p class="paragraph">
                            GARField's affinity can be recursively clustered to break a scene into smaller and smaller subcomponents automatically.
                        </p>
                        <img src="data/louvre_expanded.jpg" style="max-width: 100%" />
                    </div>
                    <div>
                        <h1>Asset Extraction</h1>
                        <p class="paragraph">
                            GARField can be used to extract 3D-complete assets from casual scene scans, which can then be simulated.
                        </p>
                        <video id="main-video" autobuffer muted autoplay loop controls>
                            <source id="mp4" src="data/drop.webm" type="video/webm">
                            <source id="mp4" src="data/drop.mp4" type="video/mp4">
                        </video>
                    </div>
                </div>
            </div>
        </div>

        <!-- Just for vertical spacing... -->
        <div class="section add-top-padding">
            <div class="base-row">
                <img src="data/favicon.png" style="height: 20px; margin-left: 5px; margin-right: 5px; margin-top: 40px; margin-bottom: 20px;">
                <img src="data/favicon.png" style="height: 20px; margin-left: 5px; margin-right: 5px; margin-top: 40px; margin-bottom: 20px;">
                <img src="data/favicon.png" style="height: 20px; margin-left: 5px; margin-right: 5px; margin-top: 40px; margin-bottom: 20px;">
            </div>
         </div>

        <div class="section base-row add-top-padding">
            <h1>Approach: Scale-Conditioned Affinity Field Training</h1>
            <p class="paragraph">
                GARField uses a contrastive loss to optimize its feature field. Given pairs of rays in a training batch, rays which land in different 2D masks are pushed apart 
                in feature space, and those within the same 2D mask are pulled together. Affinity is the L2 distance in feature space between points. 
                Features are conditioned on scale, which depends on the actual 3D size of the masks obtained via backprojection.
            </p>
            <img src="data/garfield_training.jpg" style="max-width: 100%" />
        </div>

        <!-- Motivation: importance of scale -->
        <div class="section base-row add-top-padding">
            <h1>Importance of scale</h1>
            <p class="paragraph">
                Humans can interpret a scene at multiple levels of granularity. However, this richness also creates ambiguities in grouping, 
                making it difficult to use them as supervision: Two pieces of a watermelon wedges are separate, but also part of the same 
                watermelon. To reconcile these conflicting signals into a single affinity field, GARField embraces this ambiguity through
                 physical scale, allowing a point to belong to different groups of different sizes.
            </p>
            <img src="data/multi-scale-masks.png" style="max-width: 60%" />
        </div>

        <!-- <div class="section base-row add-top-padding">
            <h1>3D Scale Preprocessing</h1>
            <p class="paragraph">
                Given only 2D groups as input, GARField must compute a physical euclidean scale to assign each. We deproject the mask onto NeRF geometry, and assign its scale to be
                the diameter of a bounding sphere after outlier removal.
            </p>
            <img src="data/garfield_preproc.jpg" style="max-width: 30%" />
        </div> -->
        <div class="section base-row add-top-padding">
            <h1>Why Multi-View?</h1>
            <p class="paragraph">
                SAM is a 2D approach and therefore the groupings suggested by it are not 3D consistent across viewpoints and scale by definition.
                 It also only allows for 3 possible groupings per point. GARField produces more complete groups by incorporating masks from many different views.
            </p>
            <img src="data/comparison_sam_garfield.jpg" style="max-width: 80%" />
        </div>

        <!-- Justify 3D scale -->
        <!-- <div class="section base-row add-top-padding">
            <h1>Why physical scale?</h1>
            <p class="paragraph">
                Groupings generated from multiple viewpoints ... fusing them together... shape and sizes may be
                mismatched due to viewpoint distance from object and occlusion... although it's the same grouping in 3D
                so we need something that's consistent across the vewpoints -- we think it's 3d
                and for this metric we choose the diameter of the bounding sphere
            </p>
            <img src="data/3d_scale.jpg" style="max-width: 100%" />
        </div> -->

        <div class="section citation add-top-padding">
            <h1 id="abstract">Citation </h1>
            <p> If you use this work or find it helpful, please consider citing: (bibtex) </p>
            <pre id="codecell0">@inproceedings{garfield2024,
&nbsp;author = {Kim, Chung Min and Wu, Mingxuan and Kerr, Justin and Tancik, Matthew and Goldberg, Ken and Kanazawa, Angjoo},
&nbsp;title = {GARField: Group Anything with Radiance Fields},
&nbsp;booktitle = {arXiv},
&nbsp;year = {2024},
} </pre>
        </div>
    </div>

    <!-- Video references for main results... -->
    <video id="bouquet" controls="false" loop autoplay muted class="videos" webkit-playsinline playsinline>
        <source src="data/renders/bouquet/concat.webm" type="video/webm">
        <source src="data/renders/bouquet/concat.mp4" type="video/mp4">
    </video>
    <video id="donuts" controls="false" loop autoplay muted class="videos" webkit-playsinline playsinline>
        <source src="data/renders/donuts/concat.webm" type="video/webm">
        <source src="data/renders/donuts/concat.mp4" type="video/mp4">
    </video>
    <video id="dozer" controls="false" loop autoplay muted class="videos" webkit-playsinline playsinline>
        <source src="data/renders/dozer/concat.webm" type="video/webm">
        <source src="data/renders/dozer/concat.mp4" type="video/mp4">
    </video>
    <video id="keyboard" controls="false" loop autoplay muted class="videos" webkit-playsinline playsinline>
        <source src="data/renders/keyboard/concat.webm" type="video/webm">
        <source src="data/renders/keyboard/concat.mp4" type="video/mp4">
    </video>
    <video id="louvre" controls="false" loop autoplay muted class="videos" webkit-playsinline playsinline>
        <source src="data/renders/louvre/concat.webm" type="video/webm">
        <source src="data/renders/louvre/concat.mp4" type="video/mp4">
    </video>
    <video id="succulent" controls="false" loop autoplay muted class="videos" webkit-playsinline playsinline>
        <source src="data/renders/succulent/concat.webm" type="video/webm">
        <source src="data/renders/succulent/concat.mp4" type="video/mp4">
    </video>
    <video id="cafe" controls="false" loop autoplay muted class="videos" webkit-playsinline playsinline>
        <source src="data/renders/nyc_cafe/concat.webm" type="video/webm">
        <source src="data/renders/nyc_cafe/concat.mp4" type="video/mp4">
    </video>


</body>